<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>JUpload - File Upload Applet (advanced js demo)</title>
</head>
<body>
<script language="javascript" src="common.js" type="text/javascript"> </script>
<div align="center"><script language="JavaScript"
    type="text/javascript">
	//All managed parameters are below, with there default value :
	postURL = "http://localhost:8080/jupload/pages/parseRequest.jsp";
	urlToSendErrorTo = ""; //Careful: log info will be truncated, if sent to a mailto: link.
	uploadPolicy = "";
	
	afterUploadURL = "";
	filenameEncoding = "";
	highQualityPreview = "";
	lang = "";
	lookAndFeel = "";
	nbFilesPerRequest = "";
	maxChunkSize = "";
	maxFileSize = "";
	maxPicHeight = "";
	maxPicWidth = "";
	debugLevel = "";
	serverProtocol = "";
	showStatusBar = "";
	stringUploadSuccess = "";
	
	//Some parameters can only be choosen from an existing list:
	uploadPolicyList = ["", "DefaultUploadPolicy", "FileByFileUploadPolicy", "PictureUploadPolicy", "CoppermineUploadPolicy"];
	//eo: esperanto
	langList = ["", "br", "de", "dk", "en", "eo", "es", "fr", "it", "ja", "nl", "no", "pl", "pt", "pt_BR", "ru", "si", "us", "zh"];
	serverProtocolList = ["", "HTTP/0.9", "HTTP/1.0", "HTTP/1.1"];

	function writeInputText (name, value, comment) {
		document.write('	<tr><td align="center">');
		document.write(name + comment);
		document.write('</td><td><INPUT TYPE="TEXT" NAME="');
		document.write(name);
		document.write('"');
		if (value != "") {
			document.write(' VALUE="');
			document.write(value);
			document.write('" ');
		}
		document.writeln(	'></td></tr>');
	}//writeInputText

	function writeInputSelect (name, value, list, comment) {
		document.write('	<tr><td align="center">');
		document.write(name);
		if (comment != '') {
			document.write(" (" + comment + ")");
		}
		document.write('</td><td><SELECT NAME="');
		document.write(name);
		document.writeln('">');

		for (i=0; i<list.length; i += 1) {
			document.write('<OPTION');
			if (value == list[i]) {
				document.write(' SELECTED');
			}
			document.write('>');
			document.writeln(list[i]);
		}
		document.writeln(	'</SELECT></td></tr>');
	}//writeInputText

	function writeParam (param, value) {
		if (value != "") {
			document.write('   <param name="');
			document.write(param);
			document.write('" VALUE="');
			document.write(value);
			document.writeln('" >');
		}
	}//writeParam

	
	//First: get possible URL parameters.
	reQuery = new RegExp ("[\?](.*)&?");
	reQuery.exec(location.href);
	query = RegExp.$1;
	
	//Then, get each parameter
	reParam = /([^&]*)=([^&]*)&?/g;
	array = reParam.exec(query);
	while (array != null) {
		val = unescape(array[2]);
		switch (array[1]) {
		case "afterUploadURL":
			afterUploadURL = val;
			break;
		case "debugLevel":
			debugLevel = val;
			break;
		case "filenameEncoding":
			filenameEncoding = val;
			break;
		case "highQualityPreview":
			highQualityPreview = val;
			break;
		case "lang":
			lang = val;
			break;
		case "lookAndFeel":
			lookAndFeel = val;
			break;
		case "maxPicHeight":
			maxPicHeight = val;
			break;
		case "maxChunkSize":
			maxChunkSize = val;
			break;
		case "maxFileSize":
			maxFileSize = val;
			break;
		case "maxPicWidth":
			maxPicWidth = val;
			break;
		case "nbFilesPerRequest":
			nbFilesPerRequest = val;
			break;
		case "postURL":
			postURL = val;
			break;
		case "serverProtocol":
			serverProtocol = val;
			break;
		case "showStatusBar":
			showStatusBar = val;
			break;
		case "stringUploadSuccess":
			stringUploadSuccess = val;
			break;
		case "uploadPolicy":
			uploadPolicy = val;
			break;
		case "urlToSendErrorTo":
			urlToSendErrorTo = val;
			break;
		default:
			alert("Unknown parameter: " + array[1]);
		}
		array = reParam.exec(query);
	}//while


	//First the form, with default values given by the query parameters.
	document.writeln('<H3>Enter Jupload parameters</H3>');
	document.writeln('<FORM>');
	document.writeln('<TABLE BORDER=0>');
	document.writeln('<TR><TD><TABLE>');
	writeInputSelect("uploadPolicy", uploadPolicy, uploadPolicyList, '');
	writeInputText("postURL", postURL, " (you can now put https URL here)");
	writeInputText("afterUploadURL", afterUploadURL, "");
	writeInputText("debugLevel", debugLevel, "");
	writeInputSelect("highQualityPreview", highQualityPreview, ["", "false", "true"], '');	
	writeInputSelect("lang", lang, langList, 'Japanese needs specific JRE extension');
	writeInputText("lookAndFeel", lookAndFeel, "");
	writeInputText("filenameEncoding", filenameEncoding, "");
	document.writeln('</TABLE></TD><TD><TABLE>');
	writeInputText("nbFilesPerRequest", nbFilesPerRequest, "");
	writeInputText("maxChunkSize", maxChunkSize, "");
	writeInputText("maxFileSize", maxFileSize, "");
	writeInputText("maxPicHeight", maxPicHeight, "");
	writeInputText("maxPicWidth", maxPicWidth, "");
	writeInputSelect("serverProtocol", serverProtocol, serverProtocolList, '');
	writeInputText("stringUploadSuccess", stringUploadSuccess, "");
	writeInputText("showStatusBar", showStatusBar, "");
	writeInputText("urlToSendErrorTo", urlToSendErrorTo, "");
	document.writeln('</TABLE></TD></TR>');
	document.writeln('</TABLE>');
	document.writeln('<input type="submit" value="Test with these parameters (don\'t forget to click on this button after parameters changes)">');
	document.writeln('</FORM>');

	//Let's write one APPLET tag for the selected language	
	document.writeln('<P><B>Caution:</B> The upload will work only if a valid postURL parameter is given. '
		+ 'By default, postURL points to localhost:8080. <BR>That can be a Tomcat server, where the wwwroot webapp of '
		+ 'jupload is deployed.</P>');
	document.writeln('<P><APPLET ');
	document.writeln('	CODE    = "wjhk.jupload2.JUploadApplet" ');
	document.writeln('	ARCHIVE = "wjhk.jupload.jar, jakarta-commons-oro.jar, jakarta-commons-net.jar" ');
	document.writeln('	WIDTH   = "640" ');
	document.writeln('	HEIGHT  = "300"');
	document.writeln('	MAYSCRIPT >');
	writeParam("postURL", postURL);
	writeParam("uploadPolicy", uploadPolicy);
	writeParam("afterUploadURL", afterUploadURL);
	writeParam("debugLevel", debugLevel);
	writeParam("filenameEncoding", filenameEncoding);
	writeParam("lang", lang);
	writeParam("lookAndFeel", lookAndFeel);
	writeParam("nbFilesPerRequest", nbFilesPerRequest);
	writeParam("maxChunkSize", maxChunkSize);
	writeParam("maxFileSize", maxFileSize);
	writeParam("maxPicHeight", maxPicHeight);
	writeParam("maxPicWidth", maxPicWidth);
	writeParam("urlToSendErrorTo", urlToSendErrorTo);
	writeParam("showStatusBar", showStatusBar);
	writeParam("stringUploadSuccess", stringUploadSuccess);
	document.writeln('Java 1.5 or higher plugin required.');
	document.writeln('</APPLET>');
</script> <script language="javascript" type=""> footer(); </script><script
    language="javascript" src="timestamp.js" type="text/javascript"></script>
</div>
</body>
</html>
